<!doctype html>
<html lang="nl">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--Stylesheets-->
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <title>JS - PE | R0849413 | Ronny Van Beek</title>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-9">
                <div class="row">
                    <div class="col-12">
                        <h1>Registreer</h1>
                        <h5>Meld je aan bij Anoroc Services, wij beschermen jouw software tegen malware!</h5>
                    </div>
                </div>
                <div class="row">
                    <form class="col-12 mt-3" name="formulier">
                        <div class="row">
                            <div class="col-6">
                                <label for="voornaam">Voornaam</label>
                                <input type="text" name="voornaam" class="form-control" id="voornaam" placeholder="Uw voornaam">
                            </div>
                            <div class="col-6">
                                <label for="naam">Naam</label>
                                <input type="text" name="naam" class="form-control" id="naam" placeholder="Uw naam">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <label for="gebruikersnaam">Gebruikersnaam</label>
                                <div class="input-group mb-2">
                                    <div class="input-group-prepend">
                                        <div class="input-group-text">@</div>
                                    </div>
                                    <input type="text" name="gebruikersnaam" class="form-control" id="gebruikersnaam" placeholder="u911236">
                                </div>
                            </div>
                            <div class="col-6">
                                <label for="email">Email</label>
                                <input type="email" name="email" class="form-control" id="email" placeholder="mail@example.be">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <label for="wachtwoord">Wachtwoord</label>
                                <input type="password" name="wachtwoord" class="form-control" aria-describedby="passwordHelp" id="wachtwoord">
                                <small id="passwordHelp" class="form-text text-muted">Je wachtwoord moet minstens 8 tekens lang zijn.</small>
                            </div>
                            <div class="col-6">
                                <label for="wachtwoordBevestiging">Herhaal wachtwoord</label>
                                <input type="password" name="wachtwoordBevestiging" class="form-control" id="wachtwoordBevestiging">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <label for="adres">Adres</label>
                                <input type="text" name="adres" class="form-control" id="adres" placeholder="Uw adres en huisnummer">
                            </div>
                        </div>
                        <div class="form-row row mt-4">
                            <div class="col-5">
                                <label class="mr-sm-2" for="Land">Land</label>
                                <select class="custom-select mr-sm-2" name="Land" id="Land">
                                        <option value="" selected>Kies een land</option>
                                        <option value="Belgie">BelgiÃ«</option>
                                        <option value="Nederland">Nederland</option>
                                    </select>
                            </div>
                            <div class="col-4">
                                <label for="provincie">Provincie</label>
                                <select class="custom-select" name="provincie" id="provincie">
                                        <option value="" selected>Kies een provincie</option>
                                        <option value="antwerpen">Antwerpen</option>
                                        <option value="limburg">Limburg</option>
                                        <option value="vlaams-brabant">Vlaams-Brabant</option>
                                        <option value="oost-vlaanderen">Oost-Vlaanderen</option>
                                        <option value="west-vlaanderen">West-Vlaanderen</option>
                                        <option value="noord-brabant">Noord-Brabant</option>
                                        <option value="zeeland">Zeeland</option>
                                    </select>
                            </div>
                            <div class="col-3">
                                <label for="postcode">Postcode</label>
                                <input type="number" name="postcode" class="form-control" id="postcode">
                            </div>
                            <!-- <div class="col-3">
                                <label for="postcode">Postcode</label>
                                <select class="custom-select" name="postcode" id="postcode">
                                        <option value="" selected>Kies een postcode</option>
                                        <option value="2300">2300</option>
                                        <option value="2330">2330</option>
                                        <option value="2400">2400</option>
                                        <option value="2440">2440</option>
                                        <option value="2370">2370</option>
                                        <option value="2470">2470</option>
                                    </select>
                            </div> -->

                        </div>
                        <div class="form-group row mt-5">
                            <div class="col-6">
                                <h3>
                                    <b>Hou me op de hoogte</b>
                                </h3>
                                <div class="custom-control custom-checkbox mr-sm-2">
                                    <input name="nieuwsbrief" type="checkbox" id="Check1" class="custom-control-input" id="customControlAutosizing">
                                    <label class="custom-control-label" for="Check1">Inschrijven voor onze nieuwsbrief</label>
                                </div>
                                <div class="custom-control custom-checkbox mr-sm-2">
                                    <input name="voorwaarden" type="checkbox" id="Check2" class="custom-control-input" id="customControlAutosizing">
                                    <label class="custom-control-label" for="Check2">Ik ga akkoord met de algemene voorwaarden.</label>
                                </div>
                            </div>
                            <div class="col-6">
                                <h3>
                                    <b>Betaling</b>
                                </h3>
                                <div class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" id="PaymentRadio1" name="gridRadios" value="Banking app" checked>
                                    <label class="custom-control-label" for="PaymentRadio1">Banking app</label>
                                </div>
                                <div class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" id="PaymentRadio2" name="gridRadios" value="Overschrijving">
                                    <label class="custom-control-label" for="PaymentRadio2">Overschrijving</label>
                                </div>
                                <div class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" id="PaymentRadio3" name="gridRadios" value="Visa card">
                                    <label class="custom-control-label" for="PaymentRadio3">Visa card</label>
                                </div>
                                <div class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" id="PaymentRadio4" name="gridRadios" value="PayPal">
                                    <label class="custom-control-label" for="PaymentRadio4">PayPal</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row my-5">
                            <div class="col-12">
                                <button id="wave" class="btn btn-primary w-100">Wave your magic wand</button>
                            </div>
                        </div>
                    </form>
                </div>

            </div>
            <div class="col-3 mt-3">
                <div class="alert alert-danger" role="alert" id="divErrors">
                    <h4>Yikes, errors..</h4>
                    <p id="errors"></p>
                </div>
                <div class="alert alert-success" role="alert" id="divVerzendebevestiging">
                    <h4>Goed gedaan!</h4>
                    <p>Aww yeah, je werd geregistreerd.</p>
                </div>
                <div class="alert alert-info" role="alert" id="divBetalingswijze">
                    <h4>Betalingswijze</h4>
                    <p id="betaalwijze"></p>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!--Scripts-->
    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script>
        //Globale variabele
        let errors = [];
        let betaalwijze = "";
        let errorsTxt = "";

        //Verbergen van de alerts bij laden van het formulier
        document.body.addEventListener("load", paginaLaden(), false);

        function paginaLaden() {
            document.querySelector("#divErrors").style.display = 'none';
            document.querySelector("#divVerzendebevestiging").style.display = 'none';
            document.querySelector("#divBetalingswijze").style.display = 'none';
            if (errorsTxt != "") {
                errorsTxt = "";
            }
        }

        //Refreshen van de pagina voorkomen na "on click"
        $("#wave").click(function() {
            event.preventDefault();
        });


        //Valideert het ingegeven e-mail adres volgens de Regex string
        function ValidateEmail(email) { //https://www.simplilearn.com/tutorials/javascript-tutorial/email-validation-in-javascript
            let validRegex = /^(?!\.)(?!\-)([a-z\d\.\-\_]+)@((?=[a-z\d]))([a-z\d\.-]+)\.([a-z]{2,8})(\.[a-z]{2,8})?$/
                //let posAt = email.indexOf('@'); //positie @ teken in e-mail
                //let user = email.substr(0, posAt); //eerste deel van e-mail adres tot aan @ teken (gebruikersnaam)
                //let domain = email.substr(posAt); //tweede deel van e-mail adres vanaf @ teken (domein)

            if (email.match(validRegex)) {
                return true;
            } else {
                return false;
            }
        }

        //divErrors en error array leegmaken na correcte ingave van het formulier.
        function ClearErrors() {
            document.getElementById("errors").innerHTML = "";
            errorsTxt = "";
            errors = [];
        }

        //functie voor controle op lege velden
        function checkEmptyField(veld, melding) {
            let lengte = veld.length;

            if (lengte < 1) {
                errors.push(melding);
                return true;
            } else {
                return false;
            }

        }

        //functie voor controle op het wachtwoord
        // 1) zijn de wachtwoordvelden ingevuld
        // 2) komt de waarde van beide velden overeen
        function controleWachtwoord() {
            let passw = document.forms["formulier"]["wachtwoord"].value;
            let passwConfirm = document.forms["formulier"]["wachtwoordBevestiging"].value;

            checkEmptyField(passw, "Het veld wachtwoord is vereist.\n");
            checkEmptyField(passwConfirm, "Het veld herhaal wachtwoord is vereist.\n");

            if (passw.length <= 7) {
                errors.push("Het wachtwoord moet minstens 7 karakters lang zijn.\n");
            } else {
                if (passw != passwConfirm) {
                    errors.push("Je wachtwoorden komen niet overeen.\n");
                }
            }

        }

        function checkPC(veld) {
            // let leeg = checkEmptyField(veld, "Het veld postcode is vereist.");
            // if (leeg == false) {

            // }

            if (veld.length > 0) {
                if (!(veld >= 1000 && veld < 10000)) {

                    errors.push("De waarde moet tussen 1000 en 9999 liggen.");
                }
            }
        }

        //Controleert de radio buttons met de naam in de parameter en geeft de waarde terug van de geselecteerde.
        function validatePayment(veld) {
            let elementen = document.getElementsByName(veld);

            for (i = 0; i < elementen.length; i++) {
                if (elementen[i].checked == true) {
                    betaalwijze = "Je betalingswijze is " + elementen[i].value;
                }
            }
            return ""
        }

        function validateForm() {
            paginaLaden();
            let firstname = document.forms["formulier"]["voornaam"].value; //Tekstvak voornaam
            let lastname = document.forms["formulier"]["naam"].value; //Tekstvak naam
            let username = document.forms["formulier"]["gebruikersnaam"].value; //Tekstvak gebruikersnaam
            let mail = document.forms["formulier"]["email"].value; //Tekstvak e-mail
            let address = document.forms["formulier"]["adres"].value; //Tekstvak adres
            let landSel = document.forms["formulier"]["Land"].value; //Keuzelijst land
            let provincieSel = document.forms["formulier"]["provincie"].value; //Keuzelijst
            //let postcodeSel = document.forms["formulier"]["postcode"].value;
            let postcodeSel = document.querySelector('#postcode').value;
            let betaalMethode = document.querySelector("#betaalwijze").textContent = validatePayment("gridRadios");
            let algVoorwaarden = document.querySelector('#Check2').checked; //Checkbox algemene voorwaarden

            checkEmptyField(firstname, "Het veld voornaam is vereist.");
            checkEmptyField(lastname, "Het veld naam is vereist.");
            checkEmptyField(username, "Het veld gebruikersnaam is vereist.");

            if (checkEmptyField(mail, "Het veld e-mail is vereist.") == false) {
                if (ValidateEmail(mail) == false) {
                    errors.push('Het veld e-mail bevat fouten.');
                }
            }

            controleWachtwoord();
            checkEmptyField(address, "Adres is vereist.");
            checkEmptyField(landSel, "Het veld land is vereist.");
            checkEmptyField(provincieSel, "Het veld provincie is vereist.");
            checkPC(postcodeSel);

            if (algVoorwaarden == false) {
                errors.push("Algemene voorwaarden moeten geaccepteerd worden.");
            }


            if (errors.length > 0) {
                for (i = 0; i < errors.length; i++) {
                    var fout = errors[i]
                    errorsTxt += fout + "<br>";
                    // for (var property in fout) {
                    //     foutenTxt += fout[property].value + "\n";
                    // }
                }
                document.getElementById("errors").textContent = "";
                document.getElementById("errors").innerHTML = errorsTxt;
                //alert(foutenTxt);
            } else {
                document.getElementById("divVerzendebevestiging").style.display = 'inherit';
                //document.querySelector("#divVerzendebevestiging").style.display = 'inherit';
            }

            if (errors.length > 0) {
                document.querySelector("#divErrors").style.display = 'inherit';
                document.querySelector("#divVerzendebevestiging").style.display = 'none';
                document.querySelector("#divBetalingswijze").style.display = 'none';
                errors = [];
                //errorsTxt = "";
            } else {
                document.querySelector("#divErrors").style.display = 'none';
                document.querySelector("#divVerzendebevestiging").style.display = 'inherit';
                document.querySelector("#divBetalingswijze").style.display = 'inherit';
            }

        }

        //functie aan knop wave toevoegen
        document.getElementById('wave').addEventListener("click", validateForm);

        //Controleert de radio buttons met de naam in de parameter en geeft de waarde terug van de geselecteerde.
        function validatePayment(veld) {
            let elementen = document.getElementsByName(veld);

            for (i = 0; i < elementen.length; i++) {
                if (elementen[i].checked == true) {
                    return "Je betalingswijze is " + elementen[i].value;
                }
            }

            // if (document.getElementById(veld).checked == true) {
            //     return document.getElementById(veld).value;
            // }
            return ""
        }
    </script>
</body>

</html>